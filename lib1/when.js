when=function(n,t){"use strict";return function(n){return n()}(function(){function n(n,t,r,u){return e(n).then(t,r,u)}function e(n){return n instanceof r?n:u(n)}function r(n,t){this._message=n,this.inspect=t}function u(n){return c(function(t){t(n)})}function i(t){return n(t,a)}function o(){function n(n,i,o){t.resolve=t.resolver.resolve=function(t){return r?u(t):(r=!0,n(t),e)},t.reject=t.resolver.reject=function(n){return r?u(a(n)):(r=!0,i(n),e)},t.notify=t.resolver.notify=function(n){return o(n),n}}var t,e,r;return t={promise:N,resolve:N,reject:N,notify:N,resolver:{resolve:N,reject:N,notify:N}},t.promise=e=c(n),t}function c(n){return f(n,I.PromiseStatus&&I.PromiseStatus())}function f(n,t){function e(n,t,e,r){function u(u){u._message(n,t,e,r)}l?l.push(u):U(function(){u(h)})}function u(){return h?h.inspect():S()}function i(n){if(l){var e=l;l=N,U(function(){h=v(f,n),t&&m(h,t),s(e,h)})}}function o(n){i(a(n))}function c(n){if(l){var t=l;U(function(){s(t,p(n))})}}var f,h,l=[];f=new r(e,u),f._status=t;try{n(i,o,c)}catch(n){o(n)}return f}function s(n,t){for(var e=0;e<n.length;e++)n[e](t)}function h(n){return l(new d(n),function(){return P(n)})}function a(n){return l(new w(n),function(){return E(n)})}function l(n,t){return new r(function(t,e,r){try{r(n[t].apply(n,e))}catch(n){r(a(n))}},t)}function p(n){return new r(function(t,e,r,u){var i=e[2];try{u("function"==typeof i?i(n):n)}catch(n){u(n)}})}function v(n,t){if(t===n)return a(new TypeError);if(t instanceof r)return t;try{var e=t===Object(t)&&t.then;return"function"==typeof e?y(e,t):h(t)}catch(n){return a(n)}}function y(n,t){return c(function(e,r){q(n,t,e,r)})}function d(n){this.value=n}function w(n){this.reason=n}function m(n,t){function e(){t.fulfilled()}function r(n){t.rejected(n)}n.then(e,r)}function b(n){return n&&"function"==typeof n.then}function j(t,e,r,u,i){return n(t,function(t){function o(r,u,i){function o(n){p(n)}function c(n){l(n)}var f,s,h,a,l,p,v,y;if(v=t.length>>>0,f=Math.max(0,Math.min(e,v)),h=[],s=v-f+1,a=[],f)for(p=function(n){a.push(n),--s||(l=p=F,u(a))},l=function(n){h.push(n),--f||(l=p=F,r(h))},y=0;y<v;++y)y in t&&n(t[y],c,o,i);else r(h)}return c(o).then(r,u,i)})}function g(n,t,e,r){function u(n){return t?t(n[0]):n[0]}return j(n,1,u,e,r)}function _(n,t,e,r){return M(n,F).then(t,e,r)}function x(){return M(arguments,F)}function T(n){return M(n,P,E)}function k(n,t){return M(n,t)}function M(t,e,r){return n(t,function(t){function u(u,i,o){var c,f,s,h;if(s=f=t.length>>>0,c=[],!s)return void u(c);for(h=0;h<f;h++)h in t?function(t,f){n(t,e,r).then(function(n){c[f]=n,--s||u(c)},i,o)}(t[h],h):--s}return f(u)})}function O(t,e){var r=q(W,arguments,1);return n(t,function(t){var u;return u=t.length,r[0]=function(t,r,i){return n(t,function(t){return n(r,function(n){return e(t,n,i,u)})})},L.apply(t,r)})}function P(n){return{state:"fulfilled",value:n}}function E(n){return{state:"rejected",reason:n}}function S(){return{state:"pending"}}function U(n){1===B.push(n)&&z(A)}function A(){s(B),B=[]}function F(n){return n}function K(n){throw"function"==typeof I.reportUnhandled?I.reportUnhandled():U(function(){throw n}),n}n.promise=c,n.resolve=u,n.reject=i,n.defer=o,n.join=x,n.all=_,n.map=k,n.reduce=O,n.settle=T,n.any=g,n.some=j,n.isPromise=b,n.isPromiseLike=b,r.prototype={then:function(n,t,e){var r,u;return r=arguments,u=this._message,f(function(n,t,e){u("when",r,n,e)},this._status&&this._status.observed())},otherwise:function(n){return this.then(N,n)},ensure:function(n){function t(){return u(n())}return"function"==typeof n?this.then(t,t).yield(this):this},done:function(n,t){this.then(n,t).otherwise(K)},yield:function(n){return this.then(function(){return n})},tap:function(n){return this.then(n).yield(this)},spread:function(n){return this.then(function(t){return _(t,function(t){return n.apply(N,t)})})},always:function(n,t){return this.then(n,n,t)}},d.prototype.when=function(n){return"function"==typeof n?n(this.value):this.value},w.prototype.when=function(n,t){if("function"==typeof t)return t(this.reason);throw this.reason};var L,W,q,z,B,C,D,G,H,I,J,N;return B=[],C=t.setTimeout,I="undefined"!=typeof console?console:n,z="object"==typeof process&&process.nextTick?process.nextTick:(J=t.MutationObserver||t.WebKitMutationObserver)?function(n,t,e){var r=n.createElement("div");return new t(e).observe(r,{attributes:!0}),function(){r.setAttribute("x","x")}}(document,J,A):function(n){C(n,0)},D=Function.prototype,G=D.call,q=D.bind?G.bind(G):function(n,t){return n.apply(t,W.call(arguments,2))},H=[],W=H.slice,L=H.reduce||function(n){var t,e,r,u,i;if(i=0,t=Object(this),u=t.length>>>0,e=arguments,e.length<=1)for(;;){if(i in t){r=t[i++];break}if(++i>=u)throw new TypeError}else r=e[1];for(;i<u;++i)i in t&&(r=n(r,t[i],i,t));return r},n})}(0,this);