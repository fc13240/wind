window.WeatherWind=function(){function t(){return/android|blackberry|iemobile|ipad|iphone|ipod|opera mini|webos/i.test(navigator.userAgent)}function n(t){return null!==t&&void 0!==t}function e(t,n){return t-n*Math.floor(t/n)}function r(t,n,e,r,a,o,i){return i[0]*=o,i[1]*=o,i}function a(t,n,e,r,a,o){var i=1-t,u=1-n,f=i*u,l=t*u,c=i*n,d=t*n,h=e[0]*f+r[0]*l+a[0]*c+o[0]*d,s=e[1]*f+r[1]*l+a[1]*c+o[1]*d;return[h,s,Math.sqrt(h*h+s*s)]}function o(t,n){var e=t.data,r=n.data;return{header:t.header,data:function(t){return[e[t],r[t]]},interpolate:a}}function i(){var t=null,n=null,e=null;return x.forEach(function(r){switch(r.header.parameterCategory+","+r.header.parameterNumber){case"2,2":t=r;break;case"2,3":n=r;break;default:e=r}}),o(t,n)}function u(){function t(t,a){var i,c=e(t-o,360)/f,d=(u-a)/l,h=Math.floor(c),v=h+1,m=Math.floor(d),p=m+1;if(i=s[m]){var g=i[h],y=i[v];if(n(g)&&n(y)&&(i=s[p])){var M=i[h],w=i[v];if(n(M)&&n(w))return r.interpolate(c-h,d-m,g,y,M,w)}}return null}var r=i(x),a=r.header,o=a.lo1,u=a.la1,f=a.dx,l=a.dy,c=a.nx,d=a.ny,h=new Date(a.refTime);h.setHours(h.getHours()+a.forecastTime);for(var s=[],v=0,m=Math.floor(c*f)>=360,p=0;p<d;p++){for(var g=[],y=0;y<c;y++,v++)g[y]=r.data(v);m&&g.push(g[0]),s[p]=g}T={date:h,interpolate:t}}function f(t,n){var e=k[Math.round(t)];return e&&e[Math.round(n)]||E}function l(t){function n(t){for(var n=[],i=0;i<=b;i+=2){var u=g([t,i]);if(u){var f=u[0],l=u[1];if(isFinite(f)){var c=T.interpolate(f,l);c&&(c=r(e,f,l,t,i,a,c),n[i+1]=n[i]=c)}}}o[t+1]=o[t]=n}var e={},a=D,o=[],i=0;!function e(){for(var r=Date.now();i<w;)if(n(i),i+=2,Date.now()-r>1e3)return void setTimeout(e,25);k=o,t()}()}function c(){function n(){r.forEach(function(t){t.length=0}),o.forEach(function(t){t.age>O&&(f.randomize(t).age=0);var n=t.x,e=t.y,a=f(n,e);if(null===a[2])t.age=O;else{var o=n+a[0],i=e+a[1];null!==f(o,i)[2]?(t.xt=o,t.yt=i,r[0].push(t)):(t.x=o,t.y=i)}t.age+=1})}function e(){var t=p.globalCompositeOperation;p.globalCompositeOperation="destination-in",p.fillRect(0,0,w,b),p.globalCompositeOperation=t,r.forEach(function(t,n){t.length>0&&(p.beginPath(),t.forEach(function(t){p.moveTo(t.x,t.y),p.lineTo(t.xt,t.yt),t.x=t.xt,t.y=t.yt}),p.stroke())})}var r=[[]],a=Math.round(w*b*N);t()&&(a*=W);for(var o=[],i=0;i<a;i++)o.push(f.randomize({age:Math.floor(Math.random()*O)+0}));!function t(){try{M=setTimeout(function(){requestAnimationFrame(t),n(),e()},1e3/z)}catch(t){console.error(t)}}()}function d(t){var n=t.particle;if(n){var e=n.canvas;e&&(w=e.width,b=e.height,p=e.getContext("2d"),p.lineWidth=n.lineWidth||C,p.strokeStyle=n.lineColor||q,p.fillStyle=R),x=t.data}y=t.project,g=t.invert}function h(t){if(s(),t&&(x=t),!x)throw new Error("please set data");p.clearRect(0,0,w,b);var n=new Date;u(),l(function(){console.log("deal data takes",new Date-n,"ms"),c()})}function s(){clearTimeout(M),f.release()}function v(t){x=t}function m(){return!!x}var p,g,y,M,w,b,x,T,k,C=1,D=.11,E=[NaN,NaN,null],N=1/80,W=.8,z=20,O=100,R="rgba(0, 0, 0, 0.97)",q="#ffffff",A={};return f.release=function(){k=[]},f.randomize=function(t){var n,e,r=0;do{n=Math.round(Math.floor(Math.random()*w)),e=Math.round(Math.floor(Math.random()*b))}while(null===f(n,e)[2]&&r++<30);return t.x=n,t.y=e,t},A.start=h,A.stop=s,A.config=d,A.setData=v,A.isReady=m,A}();