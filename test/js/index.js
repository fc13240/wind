var mymap=L.map("mapid").setView([36.165,104.585],3);L.tileLayer("http://mt{s}.google.cn/vt/lyrs=t@131,r@216000000&hl=zh-CN&gl=CN&src=app&x={x}&y={y}&z={z}&s=Gal",{maxZoom:18,minZoom:3,subdomains:["1","2","3","0"]}).addTo(mymap);var search=location.search.substr(1);if(search.indexOf("air")>-1)var bounds=new L.LatLngBounds(new L.latLng(17,72),new L.latLng(54,135)),maskLayer=L.imageOverlay("http://cdn.caiyunapp.com/res/storm_radar/pm25/20171114/2017111423.png",bounds).addTo(mymap);var isShowMask=search.indexOf("mask")>-1,particleLayer=L.canvasLayer().addTo(mymap);$(particleLayer._canvas).css({backgroundColor:"rgba(100, 100, 100, 0.2)","z-index":200});var conf={particle:{canvas:particleLayer._canvas,lineWidth:1.4,lineColor:"#ffffff"},project:function(a){var r=mymap.project(new L.latLng(a[1],a[0])),e=r._subtract(mymap.getPixelOrigin()),n=mymap.layerPointToContainerPoint(e);return[n.x,n.y]},invert:function(a){var r=mymap.containerPointToLatLng({x:a[0],y:a[1]});return[r.lng,r.lat]}};if(isShowMask){var maskLayer=L.canvasLayer().addTo(mymap);conf.mask={canvas:maskLayer._canvas,colors:[[0,"rgba(37, 74, 255, 0.3125)"],[1,"rgba(0, 99, 255, 0.3125)"],[3,"rgba(0, 199, 255, 0.3125)"],[5,"rgba(36, 193, 147, 0.3125)"],[7,"rgba(0, 230, 1, 0.3125)"],[9,"rgba(0, 250, 0, 0.3125)"],[11,"rgba(253, 226, 0, 0.3125)"],[13,"rgba(255, 175, 0, 0.3125)"],[15,"rgba(221, 74, 28, 0.3125)"],[17,"rgba(180, 0, 50, 0.3125)"],[19,"rgba(254, 0, 150, 0.3125)"],[21,"rgba(151, 50, 222, 0.3125)"],[24,"rgba(86, 54, 222, 0.3125)"],[27,"rgba(42, 131, 223, 0.3125)"],[29,"rgba(62,197,223,0.3125)"],[100,"rgba(150, 0, 255, 0.3125)"]]}}WeatherWind.config(conf);var dataUrl="./data/test.json";$.getJSON(dataUrl,function(a){WeatherWind.setData(a),WeatherWind.start()}),particleLayer.delegate({onDrawLayer:function(a){WeatherWind.isReady()&&WeatherWind.start()}});